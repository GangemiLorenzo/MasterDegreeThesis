import 'package:flutter/material.dart';
import 'package:freezed_annotation/freezed_annotation.dart';

part 'vulnerability.freezed.dart';
part 'vulnerability.g.dart';

@freezed
class Vulnerability with _$Vulnerability {
  const Vulnerability._();

  const factory Vulnerability({
    @JsonKey(name: 'Name') required String check,
    @JsonKey(name: 'Description') required String description,
    @JsonKey(name: 'Severity') required String severity,
  }) = _Vulnerability;

  factory Vulnerability.fromJson(Map<String, dynamic> json) =>
      _$VulnerabilityFromJson(json);

  Color get severityColor => switch (severity.toLowerCase()) {
        'high' => Colors.red,
        'medium' => Colors.orange,
        'low' => Colors.yellow,
        'informational' => Colors.blue,
        'optimization' => Colors.green,
        _ => Colors.red,
      };

  static Color getSeverityColor(String severity) =>
      switch (severity.toLowerCase()) {
        'high' => Colors.red,
        'medium' => Colors.orange,
        'low' => Colors.yellow,
        'informational' => Colors.blue,
        'optimization' => Colors.green,
        _ => Colors.red,
      };

  static List<String> severities = [
    'high',
    'medium',
    'low',
    'informational',
    'optimization',
  ];
}
